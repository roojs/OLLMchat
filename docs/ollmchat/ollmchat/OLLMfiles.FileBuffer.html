<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8"/>
    <title>OLLMfiles.FileBuffer &ndash; ollmchat &ndash; Vala Binding Reference</title>
    <link href="../style.css" rel="stylesheet" type="text/css"/><script src="../scripts.js" type="text/javascript">
    </script>
  </head>
  <body>
    <div class="site_header">OLLMfiles.FileBuffer &ndash; ollmchat Reference Manual</div>
    <div class="site_body">
      <div class="site_navigation">
        <ul class="navi_main">
          <li class="package_index"><a href="../index.html">Packages</a></li>
        </ul>
        <hr class="navi_hr"/>
        <ul class="navi_main">
          <li class="package"><a href="index.htm">ollmchat</a></li>
        </ul>
        <hr class="navi_hr"/>
        <ul class="navi_main">
          <li class="namespace"><a href="OLLMfiles.html">OLLMfiles</a></li>
        </ul>
        <hr class="navi_hr"/>
        <ul class="navi_main">
          <li class="interface">FileBuffer</li>
        </ul>
        <hr class="navi_hr"/>
        <ul class="navi_main">
          <li class="abstract_property"><a href="OLLMfiles.FileBuffer.file.html">file</a></li>
          <li class="abstract_property"><a href="OLLMfiles.FileBuffer.is_loaded.html">is_loaded</a></li>
          <li class="abstract_method"><a href="OLLMfiles.FileBuffer.apply_edits.html">apply_edits</a></li>
          <li class="method"><a href="OLLMfiles.FileBuffer.create_backup_if_needed.html">create_backup_if_needed</a></li>
          <li class="abstract_method"><a href="OLLMfiles.FileBuffer.get_cursor.html">get_cursor</a></li>
          <li class="abstract_method"><a href="OLLMfiles.FileBuffer.get_line.html">get_line</a></li>
          <li class="abstract_method"><a href="OLLMfiles.FileBuffer.get_line_count.html">get_line_count</a></li>
          <li class="abstract_method"><a href="OLLMfiles.FileBuffer.get_selection.html">get_selection</a></li>
          <li class="abstract_method"><a href="OLLMfiles.FileBuffer.get_text.html">get_text</a></li>
          <li class="abstract_method"><a href="OLLMfiles.FileBuffer.read_async.html">read_async</a></li>
          <li class="method"><a href="OLLMfiles.FileBuffer.read_async_real.html">read_async_real</a></li>
          <li class="abstract_method"><a href="OLLMfiles.FileBuffer.sync_to_file.html">sync_to_file</a></li>
          <li class="method"><a href="OLLMfiles.FileBuffer.update_file_metadata_after_write.html">update_file_metadata_after_write</a></li>
          <li class="abstract_method"><a href="OLLMfiles.FileBuffer.write.html">write</a></li>
          <li class="method"><a href="OLLMfiles.FileBuffer.write_real.html">write_real</a></li>
          <li class="method"><a href="OLLMfiles.FileBuffer.write_to_disk.html">write_to_disk</a></li>
        </ul>
      </div>
      <div class="site_content">
        <h1 class="main_title">FileBuffer</h1>
        <hr class="main_hr"/>
        <h2 class="main_title">Object Hierarchy:</h2>
        <img class="main_diagram" usemap="#OLLMfiles.FileBuffer" alt="Object hierarchy for FileBuffer" src="img/OLLMfiles.FileBuffer.png"/>

      <map id="OLLMfiles.FileBuffer" name="OLLMfiles.FileBuffer">
<area shape="rect" id="node1" href="OLLMfiles.FileBuffer.html" title="OLLMfiles.FileBuffer" alt="" coords="5,101,188,149"/>
</map>

        <h2 class="main_title">Description:</h2>
        <div class="main_code_definition"><span class="main_keyword">public</span> <span class="main_keyword">interface</span> <b><span class="interface">FileBuffer</span></b> : <span class="main_type"><span class="class">Object</span></span>
        </div>
        <div class="description">
          <p>Interface for file buffer operations.</p>
          <p>Provides a unified interface for accessing file contents in OLLMchat, whether in GUI contexts (using GTK SourceView buffers) or non-GUI 
            contexts (using in-memory buffers). This architecture ensures consistent file access patterns across the application while maintaining 
            separation between GUI and non-GUI code.</p>
          <p>The buffer system provides:</p>
          <ul>
            <li>Unified Interface: Same API for GTK and non-GTK contexts</li>
            <li>Type Safety: No set_data/get_data - buffers are properly typed</li>
            <li>Separation of Concerns: GUI code in liboccoder, non-GUI code in libocfiles</li>
            <li>Memory Management: Automatic cleanup of old buffers</li>
            <li>File Tracking: Automatic last_viewed timestamp updates</li>
            <li>Backup System: Automatic backups for database files</li>
            <li>Modtime Checking: GTK buffers auto-reload when files change on disk</li>
          </ul>
          <p>Buffers are stored directly on File objects via the buffer property. Each File object has at most one buffer instance, created lazily 
            when needed. Buffer type depends on BufferProvider implementation (GTK vs non-GTK).</p>
          <h2>Line Numbering </h2>
          <p>All buffer methods use 0-based line numbers internally. External APIs and user-facing operations use 1-based line numbers. Tools must 
            convert between 1-based (user input) and 0-based (buffer API).</p>
          <p>Example: <pre class="main_source"><code><span class="main_comment">// User provides: start_line=6, end_line=15 (1-based)</span><br/><span class="main_comment">// Convert to 0-based for buffer API</span><br/><span class="main_basic_type">int</span> start = start_line - <span class="main_literal">1</span>;  <span class="main_comment">// 5</span><br/><span class="main_basic_type">int</span> end = end_line - <span class="main_literal">1</span>;      <span class="main_comment">// 14</span><br/><span class="main_keyword">var</span> snippet = file.buffer.get_text(start, end);</code></pre>
          </p>
        </div>
        <div class="box">
          <div class="headline" onclick="toggle_box (this, 'box-content-49')">All known implementing classes:</div>
          <div class="content" id="box-content-49">
            <div class="column">
              <ul class="navi_inline">
                <li class="class"><a href="OLLMfiles.DummyFileBuffer.html">DummyFileBuffer</a></li>
              </ul>
            </div>
            <div class="column">
              <ul class="navi_inline">
                <li class="class"><a href="OLLMcoder.GtkSourceFileBuffer.html">GtkSourceFileBuffer</a></li>
              </ul>
            </div>
            <div class="column">
              <ul class="navi_inline">
              </ul>
            </div>
          </div>
        </div><br/>
        <div class="namespace_note"><b>Namespace:</b> <a href="OLLMfiles.html">OLLMfiles</a>
        </div>
        <div class="package_note"><b>Package:</b> <a href="index.htm">ollmchat</a>
        </div>
        <h2 class="main_title">Content:</h2>
        <h3 class="main_title">Properties:</h3>
        <ul class="navi_inline">
          <li class="abstract_property"><span class="leaf_code_definition"><span class="main_keyword">public</span> <span class="main_keyword">abstract</span> <span class="main_type"><a href="OLLMfiles.File.html" class="class">File</a></span> <b><a href="OLLMfiles.FileBuffer.file.html" class="abstract_property">file</a></b> { <span class="main_keyword">get</span>; <span class="main_keyword">set</span>; }
            </span>
            <div class="leaf_brief_description"><span class="brief_description">Reference to the file this buffer represents.</span>
            </div></li>
          <li class="abstract_property"><span class="leaf_code_definition"><span class="main_keyword">public</span> <span class="main_keyword">abstract</span> <span class="main_basic_type"><span class="struct">bool</span></span> <b><a href="OLLMfiles.FileBuffer.is_loaded.html" class="abstract_property">is_loaded</a></b> { <span class="main_keyword">get</span>; <span class="main_keyword">set</span>; }
            </span>
            <div class="leaf_brief_description"><span class="brief_description">Whether the buffer has been loaded with file content.</span>
            </div></li>
        </ul>
        <h3 class="main_title">Methods:</h3>
        <ul class="navi_inline">
          <li class="abstract_method"><span class="leaf_code_definition"><span class="main_keyword">public</span> <span class="main_keyword">abstract</span> <span class="main_keyword">async</span> <span class="main_keyword">void</span> <b><a href="OLLMfiles.FileBuffer.apply_edits.html" class="abstract_method">apply_edits</a></b> (<span class="main_type"><span class="class">ArrayList</span></span>&lt;<span class="main_type"><a href="OLLMfiles.FileChange.html" class="class">FileChange</a></span>&gt; changes) <span class="main_keyword">throws</span> <span class="main_type"><span class="class">Error</span></span>
            </span>
            <div class="leaf_brief_description"><span class="brief_description">Efficiently apply multiple edits to the buffer.</span>
            </div></li>
          <li class="method"><span class="leaf_code_definition"><span class="main_keyword">protected</span> <span class="main_keyword">async</span> <span class="main_keyword">void</span> <b><a href="OLLMfiles.FileBuffer.create_backup_if_needed.html" class="method">create_backup_if_needed</a></b> ()
            </span>
            <div class="leaf_brief_description"><span class="brief_description">Internal method: Create backup if file is in database.</span>
            </div></li>
          <li class="abstract_method"><span class="leaf_code_definition"><span class="main_keyword">public</span> <span class="main_keyword">abstract</span> <span class="main_keyword">void</span> <b><a href="OLLMfiles.FileBuffer.get_cursor.html" class="abstract_method">get_cursor</a></b> (<span class="main_keyword">out</span> <span class="main_basic_type"><span class="struct">int</span></span> line, <span class="main_keyword">out</span> <span class="main_basic_type"><span class="struct">int</span></span> offset)
            </span>
            <div class="leaf_brief_description"><span class="brief_description">Get the current cursor position.</span>
            </div></li>
          <li class="abstract_method"><span class="leaf_code_definition"><span class="main_keyword">public</span> <span class="main_keyword">abstract</span> <span class="main_basic_type"><span class="class">string</span></span> <b><a href="OLLMfiles.FileBuffer.get_line.html" class="abstract_method">get_line</a></b> (<span class="main_basic_type"><span class="struct">int</span></span> line)
            </span>
            <div class="leaf_brief_description"><span class="brief_description">Get the content of a specific line.</span>
            </div></li>
          <li class="abstract_method"><span class="leaf_code_definition"><span class="main_keyword">public</span> <span class="main_keyword">abstract</span> <span class="main_basic_type"><span class="struct">int</span></span> <b><a href="OLLMfiles.FileBuffer.get_line_count.html" class="abstract_method">get_line_count</a></b> ()
            </span>
            <div class="leaf_brief_description"><span class="brief_description">Get the total number of lines in the buffer.</span>
            </div></li>
          <li class="abstract_method"><span class="leaf_code_definition"><span class="main_keyword">public</span> <span class="main_keyword">abstract</span> <span class="main_basic_type"><span class="class">string</span></span> <b><a href="OLLMfiles.FileBuffer.get_selection.html" class="abstract_method">get_selection</a></b> (<span class="main_keyword">out</span> <span class="main_basic_type"><span class="struct">int</span></span> cursor_line, <span class="main_keyword">out</span> <span class="main_basic_type"><span class="struct">int</span></span> cursor_offset)
            </span>
            <div class="leaf_brief_description"><span class="brief_description">Get the currently selected text and cursor position.</span>
            </div></li>
          <li class="abstract_method"><span class="leaf_code_definition"><span class="main_keyword">public</span> <span class="main_keyword">abstract</span> <span class="main_basic_type"><span class="class">string</span></span> <b><a href="OLLMfiles.FileBuffer.get_text.html" class="abstract_method">get_text</a></b> (<span class="main_basic_type"><span class="struct">int</span></span> start_line = <span class="main_literal">0</span>, <span class="main_basic_type"><span class="struct">int</span></span> end_line = <span class="main_literal">-1</span>)
            </span>
            <div class="leaf_brief_description"><span class="brief_description">Get text from buffer, optionally limited to a line range.</span>
            </div></li>
          <li class="abstract_method"><span class="leaf_code_definition"><span class="main_keyword">public</span> <span class="main_keyword">abstract</span> <span class="main_keyword">async</span> <span class="main_basic_type"><span class="class">string</span></span> <b><a href="OLLMfiles.FileBuffer.read_async.html" class="abstract_method">read_async</a></b> () <span class="main_keyword">throws</span> <span class="main_type"><span class="class">Error</span></span>
            </span>
            <div class="leaf_brief_description"><span class="brief_description">Read file contents asynchronously and update buffer.</span>
            </div></li>
          <li class="method"><span class="leaf_code_definition"><span class="main_keyword">protected</span> <span class="main_keyword">async</span> <span class="main_basic_type"><span class="class">string</span></span> <b><a href="OLLMfiles.FileBuffer.read_async_real.html" class="method">read_async_real</a></b> () <span class="main_keyword">throws</span> <span class="main_type"><span class="class">Error</span></span>
            </span>
            <div class="leaf_brief_description"><span class="brief_description">Internal method: Read file from disk and update last_viewed timestamp.
              </span>
            </div></li>
          <li class="abstract_method"><span class="leaf_code_definition"><span class="main_keyword">public</span> <span class="main_keyword">abstract</span> <span class="main_keyword">async</span> <span class="main_keyword">void</span> <b><a href="OLLMfiles.FileBuffer.sync_to_file.html" class="abstract_method">sync_to_file</a></b> () <span class="main_keyword">throws</span> <span class="main_type"><span class="class">Error</span></span>
            </span>
            <div class="leaf_brief_description"><span class="brief_description">Sync current buffer contents to file (GTK buffers only).</span>
            </div></li>
          <li class="method"><span class="leaf_code_definition"><span class="main_keyword">protected</span> <span class="main_keyword">void</span> <b><a href="OLLMfiles.FileBuffer.update_file_metadata_after_write.html" class="method">update_file_metadata_after_write</a></b> ()
            </span>
            <div class="leaf_brief_description"><span class="brief_description">Internal method: Update file metadata after writing.</span>
            </div></li>
          <li class="abstract_method"><span class="leaf_code_definition"><span class="main_keyword">public</span> <span class="main_keyword">abstract</span> <span class="main_keyword">async</span> <span class="main_keyword">void</span> <b><a href="OLLMfiles.FileBuffer.write.html" class="abstract_method">write</a></b> (<span class="main_basic_type"><span class="class">string</span></span> contents) <span class="main_keyword">throws</span> <span class="main_type"><span class="class">Error</span></span>
            </span>
            <div class="leaf_brief_description"><span class="brief_description">Write contents to buffer and file on disk.</span>
            </div></li>
          <li class="method"><span class="leaf_code_definition"><span class="main_keyword">public</span> <span class="main_keyword">async</span> <span class="main_keyword">void</span> <b><a href="OLLMfiles.FileBuffer.write_real.html" class="method">write_real</a></b> (<span class="main_basic_type"><span class="class">string</span></span> contents) <span class="main_keyword">throws</span> <span class="main_type"><span class="class">Error</span></span>
            </span>
            <div class="leaf_brief_description"><span class="brief_description">Write contents to file on disk (sync buffer to file).</span>
            </div></li>
          <li class="method"><span class="leaf_code_definition"><span class="main_keyword">protected</span> <span class="main_keyword">async</span> <span class="main_keyword">void</span> <b><a href="OLLMfiles.FileBuffer.write_to_disk.html" class="method">write_to_disk</a></b> (<span class="main_basic_type"><span class="class">string</span></span> contents) <span class="main_keyword">throws</span> <span class="main_type"><span class="class">Error</span></span>
            </span>
            <div class="leaf_brief_description"><span class="brief_description">Internal method: Write contents to file on disk.</span>
            </div></li>
        </ul>
        <h3 class="main_title">Inherited Members:</h3>
        <div class="box">
          <div class="headline" onclick="toggle_box (this, 'box-content-50')">All known members inherited from class GLib.Object</div>
          <div class="content" id="box-content-50">
            <div class="column">
              <ul class="navi_inline">
                <li class="method">@get</li>
                <li class="static_method">@new</li>
                <li class="method">@ref</li>
                <li class="method">@set</li>
                <li class="method">add_toggle_ref</li>
                <li class="method">add_weak_pointer</li>
                <li class="method">bind_property</li>
                <li class="method">connect</li>
                <li class="virtual_method">constructed</li>
                <li class="method">disconnect</li>
                <li class="virtual_method">dispose</li>
                <li class="method">dup_data</li>
                <li class="method">dup_qdata</li>
                <li class="method">force_floating</li>
                <li class="method">freeze_notify</li>
                <li class="method">get_class</li>
                <li class="method">get_data</li>
              </ul>
            </div>
            <div class="column">
              <ul class="navi_inline">
                <li class="method">get_property</li>
                <li class="method">get_qdata</li>
                <li class="method">get_type</li>
                <li class="method">getv</li>
                <li class="static_method">interface_find_property</li>
                <li class="static_method">interface_install_property</li>
                <li class="static_method">interface_list_properties</li>
                <li class="method">is_floating</li>
                <li class="static_method">new_valist</li>
                <li class="static_method">new_with_properties</li>
                <li class="static_method">newv</li>
                <li class="signal">notify</li>
                <li class="method">notify_property</li>
                <li class="field">ref_count</li>
                <li class="method">ref_sink</li>
                <li class="method">remove_toggle_ref</li>
                <li class="method">remove_weak_pointer</li>
              </ul>
            </div>
            <div class="column">
              <ul class="navi_inline">
                <li class="method">replace_data</li>
                <li class="method">replace_qdata</li>
                <li class="method">set_data</li>
                <li class="method">set_data_full</li>
                <li class="method">set_property</li>
                <li class="method">set_qdata</li>
                <li class="method">set_qdata_full</li>
                <li class="method">set_valist</li>
                <li class="method">setv</li>
                <li class="method">steal_data</li>
                <li class="method">steal_qdata</li>
                <li class="method">thaw_notify</li>
                <li class="method">unref</li>
                <li class="method">watch_closure</li>
                <li class="method">weak_ref</li>
                <li class="method">weak_unref</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div><br/>
    <div class="site_footer">Generated by <a href="https://docs.vala.dev"><kbd>valadoc</kbd></a>
    </div>
  </body>
</html>