# 1.3.9. Agent Configuration

## Overview

Implement the Agents tab in the Settings dialog for managing agent configurations. This includes the AgentsPage UI component for listing, adding, editing, and removing agent configurations.

## Status

‚è≥ **TODO** - Not implemented yet.

## Related Plans

- **1.3** - Configuration Overview
- **1.3.2** - Configuration Interface (SettingsDialog structure)
- **1.7** - Agent Management System (agent selector UI, multiple agents)

## Agents Tab

**Purpose**: Manage agent configurations (add, edit, remove agents).

**Components**:
- **Horizontal Box (Action Bar)**: Top horizontal container with action buttons
  - **Add Agent Button**: Opens dialog for adding new agent configuration
  - **Adw.SearchBar**: Search bar for filtering agents (optional)
- **Adw.PreferencesGroup**: Contains the agent list
  - Wraps `Adw.BoxedList` for consistent styling
- **Agent List**: Uses `Adw.BoxedList` to display all agent configurations
  - Each agent uses `Adw.ExpanderRow` to show/edit agent details inline
  - Each agent shows: name, type, description (when collapsed)
  - When expanded: Shows editable form fields with Remove button at bottom
  - Editing is inline - no separate edit mode needed
- **Agent Details Panel**: Uses `Adw.ExpanderRow` - inline editable form for agent properties
  - Settings widgets are added as children to the `Adw.ExpanderRow` using `add_row()`
  - Uses `Adw.ActionRow` with suffix widgets for form fields
  - Name: Agent name/identifier (Gtk.Entry as suffix)
  - Type: Agent type (e.g., "Code Assistant", "Just Ask") (Gtk.DropDown as suffix)
  - Description: Agent description (Gtk.Entry as suffix)
  - Model: Default model for this agent (Gtk.DropDown as suffix)
  - Tools: Enabled tools for this agent (multi-select widget)
  - **Action Buttons** (shown at bottom, in Gtk.Box):
    - **Remove Button** (red, left side): Removes agent from configuration
    - **Save Button** (green/blue, right side): Saves agent configuration

**Data Source**: `Config2.agents` (Gee.Map<string, AgentConfig> or similar structure)

## Implementation Details

### Files to Create

**AgentsPage**
- **Location**: `ollmchat/Settings/AgentsPage.vala`
- **UI Framework**: Uses `Adw.PreferencesPage` with:
  - Horizontal box at top containing Add Agent button and optional search bar
  - `Adw.PreferencesGroup` wrapping `Adw.BoxedList` for agent list
  - Agent rows use `Adw.ExpanderRow` for expandable agent settings panels
  - Settings widgets added to `Adw.ExpanderRow` via `add_row()` method
  - See [Adw.ExpanderRow documentation](https://valadoc.org/libadwaita-1/Adw.ExpanderRow.html)
- **Purpose**: Agents tab content
- **Properties**:
  - `settings_dialog` (SettingsDialog) - Reference to parent SettingsDialog (which has the config object)
- **Methods**:
  - `add_agent()` - Opens dialog for adding new agent
  - `remove_agent(string agent_id)` - Removes agent from `config.agents` map
  - `render_agents()` - Creates UI entries from `config.agents` map
  - `add_agent_row(string agent_id, AgentConfig agent)` - Creates expandable row for an agent with form fields

### Files to Modify

- `ollmchat/Settings/SettingsDialog.vala` - Add Agents tab to view stack
- `libollmchat/Config.vala` - Add agents storage structure (if not already present)

## Integration Points

- **Config2**: Agent configurations stored in `Config2.agents` map
- **SettingsDialog**: Main dialog window that contains the Agents tab
- **Agent Management**: Integrates with agent system from plan 1.7

## Future Considerations

- **Agent Templates**: Pre-defined agent templates for common use cases
- **Agent Import/Export**: Share agent configurations between installations
- **Agent Presets**: Quick switching between agent configurations

