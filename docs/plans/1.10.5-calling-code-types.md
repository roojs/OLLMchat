# Table support Phase 5: Calling code and Types (1.10.5)

Part of the phased implementation for markdown table support; see **1.8.2-table-support-current-design.md** for the overall design and phase order. Depends on **1.10.4-table-handling.md** (handle_table_line).

---

## Goal

In **handle_block_result**, when `matched_block == TABLE`, set `current_block = TABLE` and split the consumed 3-line block into 3 lines and call handle_table_line(line) three times. In **add()**, at line start, if `current_block == TABLE` get the rest of the line and call handle_table_line(line) (or end table if the line doesn't look like a table row). Add any **Types** (e.g. table alignment enum) needed. Implement **handle_line_break** and **do_block** branches for TABLE.

## File

`libocmarkdown/Parser.vala`

## Code to add

- **handle_block_result:** In the switch on `matched_block`, add case `FormatType.TABLE`: set `current_block = TABLE`, split the chunk from `chunk_pos` to `chunk_pos + byte_length` into 3 lines (by newline), call `handle_table_line(line)` for each, advance `chunk_pos` by `byte_length`.

- **add():** Before "At line start â€“ check for block markers", add: if `current_block == TABLE`, get the rest of the line (up to newline), if it looks like a table row (ends with `|`) call handle_table_line(line) and advance chunk_pos; else call do_block(false, TABLE), set current_block = NONE, and don't advance (so the line is re-processed).

- **handle_line_break:** Add branch for `current_block == TABLE`: do not call do_block(false); just advance past the newline and set at_line_start = true.

- **do_block:** Add case `FormatType.TABLE` for is_start = false: call `renderer.on_table(false)`.
