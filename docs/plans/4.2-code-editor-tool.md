# 4.2. Code Editor Interface

## Overview

Code editor tool for viewing and approving changes to files. Allows users to review and approve file changes before they are applied.

## Status

‚è≥ **TODO** - Complex UI enhancement to be implemented.

## Implementation Details

### Features
- View file changes in code editor
- Approve changes to files
- Track approved file versions
- Handle partial file approvals
- Project and file selection with searchable dropdowns

### Data Bootstrap Sources

The code editor will bootstrap project and file data from multiple sources:

1. **Cursor SQLite Database**
   - Path: `~/.config/Cursor/User/globalStorage/state.vscdb`
   - Query: `SELECT value FROM ItemTable WHERE key = 'history.recentlyOpenedPathsList';`
   - Extracts recently opened file paths from Cursor

2. **roobuilder Projects List**
   - Path: `~/.config/roobuilder/Projects.list`
   - Contains project information from roobuilder

3. **VS Code Storage**
   - Path: `~/.config/Code/storage.json`
   - Contains VS Code workspace and file history

### UI Design

#### Layout
- **Header Bar**: Positioned above the sourceview
  - **Project Pulldown**: Searchable dropdown for selecting projects
  - **File Pulldown**: Searchable dropdown for selecting files within the selected project
- **SourceView**: Code editor component below the header bar

#### Searchable Dropdowns
- Both project and file dropdowns support search/filter functionality
- Users can type to filter available options
- Dropdowns populate from bootstrapped data sources

### Complex Requirements

#### Auto-commit Assumption
- All changes are assumed to be auto-committed
- **Important**: Git committing automatically should NOT be done on main/master branch
- Use work-in-progress branch for automatic commits
- Need to track which version of file has been approved

#### Approval States
1. **Full file approval**: Jumps to the approved state of the file
2. **Partial file approval**: More complicated
   - Need temporary approved copy of the file
   - Diff against temporary approved copy
   - When further changes occur, compare to temporary approved copy rather than committed copy
   - Handle sliding window between approval process

#### Version Tracking
- Track approved file version
- Maintain temporary approved copy for partial approvals
- Diff management between approved and current state

### Files to Create/Modify
- Code editor component with diff view
- Approval UI
- File version tracking system
- Temporary file management for partial approvals

### Implementation Notes
- Design approval workflow
- Handle edge cases in partial approval
- Manage temporary approved file copies
- Diff algorithm for comparing against approved state
- UI for showing changes and approval status
