# 1.2.6.1. Update Client Method Signatures

## Overview

Update Client convenience methods to require `model` as a parameter and make `options` optional, instead of getting model from config.

**Parent Plan**: [1.2.6. Update Legacy Methods](./1.2.6-update-legacy-methods.md)

## Status

âœ… **DONE** - All method signatures updated.

## Goal

Make the simple wrapper API more explicit by requiring `model` as a parameter. This aligns with plan 1.2's principle that Client should not hold request-specific configuration.

## Current Implementation

Currently, all methods get model from config:
- `Client.chat()` - Gets model from `config.get_default_model()`, throws error if not available
- `Client.embed()` - Gets model from `config.get_default_model()`, throws error if not available
- `Client.embed_array()` - Gets model from `config.get_default_model()`, throws error if not available
- `Client.generate()` - Gets model from `config.get_default_model()`, throws error if not available

## Target Implementation

Update method signatures to require `model` and make `options` optional:

```vala
// chat()
public async Response.Chat chat(
    string model,
    string text,
    Call.Options? options = null,
    GLib.Cancellable? cancellable = null
) throws Error

// embed()
public async Response.Embed embed(
    string model,
    string input,
    int dimensions = -1,
    bool truncate = false,
    Call.Options? options = null,
    GLib.Cancellable? cancellable = null
) throws Error

// embed_array()
public async Response.Embed embed_array(
    string model,
    Gee.ArrayList<string> input_array,
    int dimensions = -1,
    bool truncate = false,
    Call.Options? options = null,
    GLib.Cancellable? cancellable = null
) throws Error

// generate()
public async Response.Generate generate(
    string model,
    string prompt,
    string system = "",
    Call.Options? options = null,
    GLib.Cancellable? cancellable = null
) throws Error
```

## Implementation Steps

### Step 1: Update Client.chat()

**File**: `libollmchat/Client.vala` (line ~177)

**Current**:
```vala
public async Response.Chat chat(string text, GLib.Cancellable? cancellable = null) throws Error
{
    // Get model from config
    string model = "";
    if (this.config != null) {
        model = this.config.get_default_model();
    }
    if (model == "") {
        throw new OllamaError.INVALID_ARGUMENT("Client.chat() requires a model. Set config and default_model, or use Call.Chat directly.");
    }
    // ...
}
```

**New**:
```vala
public async Response.Chat chat(
    string model,
    string text,
    Call.Options? options = null,
    GLib.Cancellable? cancellable = null
) throws Error
{
    if (model == "") {
        throw new OllamaError.INVALID_ARGUMENT("Client.chat() requires a model parameter.");
    }
    
    if (options == null) {
        options = new Call.Options();
    }
    
    var call = new Call.Chat(this.connection, model, options) {
        cancellable = cancellable,
        stream = true,
        think = true
    };
    // ... rest of implementation
}
```

**Test**: Verify `Client.chat()` works with new signature

### Step 2: Update Client.embed()

**File**: `libollmchat/Client.vala` (line ~356)

**Current**: Gets model from config

**New**: Require model parameter, make options optional

**Test**: Verify `Client.embed()` works with new signature

### Step 3: Update Client.embed_array()

**File**: `libollmchat/Client.vala` (line ~409)

**Current**: Gets model from config

**New**: Require model parameter, make options optional

**Test**: Verify `Client.embed_array()` works with new signature

### Step 4: Update Client.generate()

**File**: `libollmchat/Client.vala` (line ~461)

**Current**: Gets model from config

**New**: Require model parameter, make options optional

**Test**: Verify `Client.generate()` works with new signature

## Breaking Changes

**Breaking Change**: All methods now require `model` as explicit parameter. This is intentional to make the API more explicit and align with plan 1.2's principle that Client should not hold request-specific configuration.

## Files to Modify

- `libollmchat/Client.vala` - Update all four method signatures

## Related Plans

- [1.2.6.2. Update Session.chat()](./1.2.6.2-update-session-chat.md) - Will need updating after this
- [1.2.6.3. Update TitleGenerator](./1.2.6.3-DONE-update-title-generator.md) - Will need updating after this
- [1.2.6.4. Update VectorBuilder](./1.2.6.4-DONE-update-vector-builder.md) - **DONE**: Updated to take Config2 and get model from "embed_model" usage entry
- [1.2.6.5. Update Database](./1.2.6.5-update-database.md) - Will need updating after this
- [1.2.6.6. Update Search](./1.2.6.6-DONE-update-search.md) - **DONE**: Updated after this

