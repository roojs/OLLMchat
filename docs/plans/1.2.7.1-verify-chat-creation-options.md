# 1.2.7.1. Verify Chat Creation Options

## Overview

Ensure all Chat creation points properly set `options` from config when available, rather than always using defaults. This is a prerequisite check before moving signals from Client to Chat.

**Parent Plan**: [1.2.7. Move Remaining Signals from Client to Chat](./1.2.7-move-signals-to-chat.md)

## Status

‚è≥ **TODO** - Prerequisite check before signal migration.

## Goal

Verify all Chat creation points properly handle options from config when available, falling back to `new Call.Options()` only when config is not available.

## Implementation Steps

### Step 0.1: Verify All Chat Creation Points Set Options Properly

**Goal**: Ensure all Chat creation points properly set `options` from config when available, rather than always using defaults.

**Check**: Review all Chat creation points to ensure they:
1. Get `options` from config when available (using `config.model_options.get(model)` or `config.usage.get("default_model")`)
2. Fall back to `new Call.Options()` only when config is not available
3. Explicitly set `options` on the Chat object

**Files to check**:
- `libollmchat/Client.vala` - `chat()` (has TODO comment), `embed()`, `generate()` methods
- `libollmchat/Settings/Config2.vala` - `create_chat()` method
- `libocvector/Indexing/Analysis.vala` - Chat creation
- `libollmchat/History/Manager.vala` - `new_client()` method
- `libollmchat/History/SessionBase.vala` - Chat creation in constructor
- `libollmchat/Prompt/AgentHandler.vala` - Chat creation
- `liboccoder/Prompt/CodeAssistantHandler.vala` - Chat creation

**Note**: `keep_alive` defaults to `null` (not set), which is acceptable for normal usage. Only set if explicitly needed.

**Result**: All Chat creation points properly handle options from config

## Files to Modify

- `libollmchat/Client.vala` - Verify `chat()`, `embed()`, `generate()` methods
- `libollmchat/Settings/Config2.vala` - Verify `create_chat()` method
- `libocvector/Indexing/Analysis.vala` - Verify Chat creation
- `libollmchat/History/Manager.vala` - Verify `new_client()` method
- `libollmchat/History/SessionBase.vala` - Verify Chat creation in constructor
- `libollmchat/Prompt/AgentHandler.vala` - Verify Chat creation
- `liboccoder/Prompt/CodeAssistantHandler.vala` - Verify Chat creation

## Testing Checklist

- [ ] All Chat creation points properly set `options` from config when available (Phase 0.1)
- [ ] All Chat creation points fall back to `new Call.Options()` when config is not available
- [ ] Options are explicitly set on Chat objects

## Related Plans

- [1.2.7. Move Remaining Signals from Client to Chat](./1.2.7-move-signals-to-chat.md) - Parent plan
- [1.2. Refactor Client and Chat Relationship](./1.2-refactor-client-chat-relationship.md) - Grandparent plan

