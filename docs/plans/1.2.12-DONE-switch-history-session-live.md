# 1.2.12 - Switch History Session Live

## Problem

When switching back to a session that's still streaming, new chunks are not displayed because:
- `ChatWidget.on_stream_chunk_handler()` checks `is_streaming_active` (line 417)
- When switching sessions, `is_streaming_active` is always set to `false` (line 192), even if the session is still running
- `session.is_running` is the source of truth, but the handler doesn't check it

## Solution

Replace `is_streaming_active` check with `session.is_running` in the stream chunk handler.

## Changes

### File: `libollmchatgtk/ChatWidget.vala`

**1. Remove `is_streaming_active` variable (line 40)**:
```vala
// Remove this line:
private bool is_streaming_active = false;
```

**2. Update `on_stream_chunk_handler()` (line 417)**:

Change:
```vala
if (!this.is_streaming_active) {
    return;
}
```

To:
```vala
if (!this.manager.session.is_running) {
    return;
}
```

**3. Update `handle_error()` (line 557)**:

Change:
```vala
if (this.is_streaming_active) {
    this.chat_view.finalize_assistant_message();
}
```

To:
```vala
if (this.manager.session.is_running) {
    this.chat_view.finalize_assistant_message();
}
```

**4. Remove all assignments to `is_streaming_active`**:
- Line 192: Remove `this.is_streaming_active = false;` (in `switch_to_session()`)
- Line 324: Remove `this.is_streaming_active = true;` (in `on_message_created()`)
- Line 458: Remove `this.is_streaming_active = false;` (in `on_stream_chunk_handler()`)
- Line 480: Remove `this.is_streaming_active = true;` (in `on_send_clicked()`)
- Line 582: Remove `this.is_streaming_active = false;` (in `cleanup_streaming_state()`)
- Line 590: Remove `this.is_streaming_active = false;` (in `on_stop_clicked()`)

**Note**: `session.is_running` is the source of truth. All these assignments are redundant since `Session` manages `is_running` state.
