# 1.6. Tools Management

## Overview

Tool configuration and management system for enabling/disabling tools, configuring tool-specific settings, and managing tool permissions. Works with client configuration from plan 1.4 to register and configure tools.

## Status

‚è≥ **TODO** - Review and improve.

## Related Plans

- **1.4** - Client Configuration Setup (uses client connections for tool setup)

## Implementation Details

### Current Situation
- Tools are registered with Client
- Chat may have specific tool configurations
- Need to ensure tools work correctly with Chat configuration

### Tool Settings Structure
- **Tool Registry**: List of available tools
- **Tool Properties**:
  - Enabled/disabled state
  - Tool-specific configuration
  - Permission settings
  - Tool dependencies

### Tool Management UI
- **Tool List**: Display all available tools
- **Enable/Disable Toggle**: Per-tool enable/disable
- **Tool Configuration**: Tool-specific settings panels
- **Tool Information**: Display tool description and capabilities

### Tool-Specific Configurations

#### Codebase Search Tool
- **Embedding Model**: Select model for embeddings
- **Embedding Options**: Temperature, context size for embeddings
- **Vector Database Path**: Custom path for vector storage
- **Index Settings**: Auto-index, indexing frequency
- **Note**: Currently uses `embed.json` config file - should integrate into main settings

#### File Tools
- **Read File**: Max file size, allowed extensions
- **Edit File**: Backup settings, auto-format

#### Terminal Command Tool
- **Working Directory**: Default directory
- **Allowed Commands**: Whitelist/blacklist
- **Timeout Settings**: Command execution timeout

#### Web Tools
- **Web Search**: Search engine selection, API keys
- **Web Fetch**: Timeout, max response size

### Tool Configuration Storage
```json
{
  "tools": {
    "read_file": {
      "enabled": true,
      "max_file_size": 10485760,
      "allowed_extensions": []
    },
    "codebase_search": {
      "enabled": true,
      "embed_model": "nomic-embed-text",
      "embed_options": {
        "temperature": 0.0,
        "num_ctx": 2048
      },
      "vector_db_path": "~/.local/share/ollmchat/codedb.faiss.vectors"
    },
    "run_terminal_command": {
      "enabled": true,
      "default_directory": "~",
      "timeout": 30
    }
  }
}
```

### Tool Registration System
- **Dynamic Tool Loading**: Support for loading tools at runtime
- **Tool Discovery**: Scan for available tools
- **Tool Dependencies**: Handle tool dependencies
- **Custom Tools**: Future support for user-defined tools

### Features
- Tools available from client
- Tools active based on Chat configuration
- Tool enablement/disablement per chat
- Tool permission management per chat

### Files to Create
- `ollmchat/Settings/ToolsPage.vala` - Tools settings page
- `libollmchat/Settings/ToolConfig.vala` - Tool configuration (optional)

### Files to Modify
- `libollmchat/Client.vala` - Tool registration
- `libollmchat/Call/Chat.vala` - Tool configuration
- `libollmchat/Tool/Interface.vala` - Add configuration interface for tools
- `ollmchat/Window.vala` - Register tools based on settings

### Implementation Notes
- Review current tool system (should be better after refactoring)
- Ensure tools respect Chat configuration
- Handle tool availability per chat
- Verify tool permissions work correctly with multiple chats

### Tool Configuration Interface
- **Tool Interface Extension**: Add `get_config_schema()` method
- **Configuration UI**: Generate UI from schema
- **Validation**: Validate tool configurations

### Future Considerations
- **Tool Plugin System**: Support for loading external tools
- **Tool Marketplace**: Repository of community tools
- **Tool Development**: API for creating custom tools
