# 1.14. URGENT - Add Current Date to System Prompt Injection

## Overview

Add the current date to the system prompt injection in the "CodeAssistant" agent. The system prompt injection already exists via the `generate_user_info_section()` method, which includes OS Version, Workspace Path, and Shell. This change will add the current date to that section so the LLM has temporal context.

**Note**: This change applies only to CodeAssistant. JustAsk is left unchanged for now.

## Status

‚è≥ **TODO** - Not yet implemented.

## Problem

The LLM gets confused about all of the complexity in the current system prompts, tool descriptions, and agent configurations. The system prompt injection already exists in the `generate_user_info_section()` method, but it doesn't include the current date, which would provide useful temporal context to the LLM.

## Solution

Add the current date to the `generate_user_info_section()` method in CodeAssistant. This method is already used by CodeAssistant to inject system information into its prompts. Adding the date will give the LLM temporal awareness.

## Implementation Details

### Add Current Date to CodeAssistant's generate_user_info_section()

#### File: `liboccoder/AgentFactory.vala`

CodeAssistant has its own private `generate_user_info_section()` method (around line 296-311). Modify it to include the current date:

```vala
private string generate_user_info_section()
{
    var result = "<user_info>\n";
    result += "OS Version: " + this.get_os_version() + "\n";
    
    // Add current date
    var now = new DateTime.now_local();
    var date_str = now.format("%Y-%m-%d");
    result += "Current Date: " + date_str + "\n";
    
    var workspace_path = this.get_workspace_path();
    if (workspace_path != "") {
        result += "Workspace Path: " + workspace_path + "\n";
    }
    
    if (this.shell != "") {
        result += "Shell: " + this.shell + "\n";
    }
    result += "</user_info>";
    return result;
}
```

**Note**: JustAsk is left unchanged for now. Only CodeAssistant will include the date.

## Related Plans

- **1.7** - Agent Management System (agent registration and management)
- **4.5** - Coding Agent Missing Bits (CodeAssistant implementation)
- **2.10** - Codebase Search Tool (tool used by CodeAssistant)

## Files to Modify

1. `liboccoder/AgentFactory.vala` - Add current date to `generate_user_info_section()` method (around line 296-311)

## Usage Example

After implementation, the CodeAssistant user info section will include the current date:

```
<user_info>
OS Version: linux 6.14.0-37-generic
Current Date: 2025-01-15
Workspace Path: /home/user/project
Shell: /usr/bin/bash
</user_info>
```

## Notes

- Date format: YYYY-MM-DD (e.g., "2025-01-15")
- Uses `DateTime.now_local()` to get the current local date
- Only CodeAssistant will include the date (JustAsk is left unchanged)
- The date is generated fresh each time `generate_user_info_section()` is called, so it's always current
